<!DOCTYPE html><html><head>
      <title>Android 15 升级</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\KTing\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.15\crossnote\dependencies\katex\katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<p>Xtrend Speed 项目 Android 15 升级</p>
<p><strong>升级修改</strong></p>
<pre data-role="codeBlock" data-info="java" class="language-java java"><code>ext <span class="token punctuation">{</span>
  compileSdkVersion <span class="token operator">=</span> <span class="token number">35</span>
  targetSdkVersion <span class="token operator">=</span> <span class="token number">35</span>
<span class="token punctuation">}</span>

</code></pre><h1 id="问题一">问题一 </h1>
<p>Failed to load resources table in APK 'D:\ZZTAndroid\Sdk\platforms\android-35\android.jar'.</p>
<p><strong>解决方法</strong></p>
<p><a href="https://planet.kde.org/hanyangzhang-2024-07-23-building-and-running-qml-android-applications/">https://planet.kde.org/hanyangzhang-2024-07-23-building-and-running-qml-android-applications/</a></p>
<p>升级 gradle 8.4.1<br>
dependencies {<br>
classpath 'com.android.tools.build:gradle:8.4.1'<br>
}</p>
<hr>
<h1 id="问题二-升级-gradle">问题二 升级 Gradle </h1>
<ol>
<li>修改</li>
</ol>
<ul>
<li>升级 AGP Version   8.4.1</li>
<li>升级 Gradle Version  8.7</li>
</ul>
<p>解决方法</p>
<p><img src="https://gitee.com/ZeTing/UploadImg/raw/main/img/20250123114803.png" alt=""></p>
<ol start="2">
<li>添加 namespace</li>
</ol>
<pre data-role="codeBlock" data-info="" class="language-text"><code>android {
    namespace 'com.easylife.ten.lib'
}
</code></pre><h2 id="jdk-要升级">jDK 要升级 </h2>
<p>Gradle JVM version incompatible.<br>
This project is configured to use an older Gradle JVM that supports up to version 11 but the current AGP requires a Gradle JVM that supports version 17.</p>
<p><strong>解决方法</strong></p>
<p>修改jdk 17</p>
<h2 id="修改后执行不成功--switchtodebug-任务失败">修改后执行不成功  switchToDebug 任务失败 </h2>
<p>Reason: Task ':AppCommon:process_debugDebugGoogleServices' uses this output of task ':AppCommon:switchToDebug' without declaring an explicit or implicit dependency. This can lead to incorrect results being produced, depending on what order the tasks are executed.</p>
<p><strong>解决方法</strong></p>
<p><font color="red">暂时没有解决方案，先给去掉</font></p>
<h2 id="错误找不到-tvdanmakuijkmediaplayer-包下类容">错误找不到 tv.danmaku.ijk.media.player 包下类容 </h2>
<p>错误: 找不到符号<br>
import tv.danmaku.ijk.media.player.IIjkMediaPlayer;</p>
<p><strong>解决方法</strong></p>
<p>build.gradle 文件加下添加 aidl 配置</p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>android {
/*生成 AIDL 文件对应Class类*/
  buildFeatures{
      aidl true
  }
}
</code></pre><p><img src="https://gitee.com/ZeTing/UploadImg/raw/main/img/20250123134248.png" alt=""></p>
<h2 id="错误-jvm-和-kotlin-版本问题">错误 jvm 和 kotlin 版本问题 </h2>
<ul>
<li>What went wrong:<br>
Execution failed for task ':AppCommon:kaptGenerateStubs_debugDebugKotlin'.</li>
</ul>
<blockquote>
<p>Inconsistent JVM-target compatibility detected for tasks 'compile_debugDebugJavaWithJavac' (1.8) and 'kaptGenerateStubs_debugDebugKotlin' (17).</p>
</blockquote>
<p><strong>解决方法</strong></p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>android {
  compileOptions {
      sourceCompatibility JavaVersion.VERSION_17
      targetCompatibility JavaVersion.VERSION_17
  }

}
</code></pre><hr>
<h1 id="问题三--transform-已经被删除无痕埋点需要重新写">问题三  Transform 已经被删除，无痕埋点需要重新写 </h1>
<h3 id="autotrackings-项目以下文件变更">autotrackings 项目以下文件变更 </h3>
<p>修改文件目录结构<br>
<img src="https://gitee.com/ZeTing/UploadImg/raw/main/img/20250123164723.png" alt=""></p>
<ul>
<li>build.gradle</li>
</ul>
<pre data-role="codeBlock" data-info="groovy" class="language-groovy groovy"><code>apply plugin<span class="token punctuation">:</span> <span class="token string">'groovy'</span>
apply plugin<span class="token punctuation">:</span> <span class="token string">'maven-publish'</span>

dependencies <span class="token punctuation">{</span>
    implementation <span class="token function">fileTree</span><span class="token punctuation">(</span>dir<span class="token punctuation">:</span> <span class="token string">'libs'</span><span class="token punctuation">,</span> include<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'*.jar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment">//gradle sdk</span>
    implementation <span class="token function">gradleApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//groovy sdk</span>
    implementation <span class="token function">localGroovy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//引入java的gradle api，使用groovy实现则不需要引用</span>
    implementation <span class="token string">'com.android.tools.build:gradle:7.1.3'</span>
    <span class="token comment">// 引入asm</span>
    <span class="token function">compileOnly</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">"org.ow2.asm:asm-commons:9.6"</span></span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>
compileGroovy <span class="token punctuation">{</span>
    targetCompatibility <span class="token operator">=</span> JavaVersion<span class="token punctuation">.</span>VERSION_17
    sourceCompatibility <span class="token operator">=</span> JavaVersion<span class="token punctuation">.</span>VERSION_17
    options<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">"UTF-8"</span></span>
<span class="token punctuation">}</span>

<span class="token comment">// 上传到本地repo目录</span>
publishing <span class="token punctuation">{</span>
    publications <span class="token punctuation">{</span>
        <span class="token function">maven</span><span class="token punctuation">(</span>MavenPublication<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            groupId <span class="token operator">=</span> <span class="token string">'com.jjshome.mobile'</span>
            artifactId <span class="token operator">=</span> <span class="token string">'tracking-plugin'</span>
            version <span class="token operator">=</span> <span class="token string">'1.5'</span>
            from components<span class="token punctuation">.</span>java
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    repositories <span class="token punctuation">{</span>
        maven <span class="token punctuation">{</span>
            url <span class="token operator">=</span> <span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">'../repo'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><ul>
<li>tracking.leyoujia.properties</li>
</ul>
<pre data-role="codeBlock" data-info="java" class="language-java java"><code>#implementation<span class="token operator">-</span><span class="token keyword keyword-class">class</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>jjshome<span class="token punctuation">.</span>mobile<span class="token punctuation">.</span>autotrackings<span class="token punctuation">.</span></span>TrackingPlugin</span>
implementation<span class="token operator">-</span><span class="token keyword keyword-class">class</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>jjshome<span class="token punctuation">.</span>mobile<span class="token punctuation">.</span>autotrackings<span class="token punctuation">.</span></span>TrackingPlugin80</span>
</code></pre><ul>
<li>TrackingPlugin80</li>
</ul>
<pre data-role="codeBlock" data-info="java" class="language-java java"><code><span class="token keyword keyword-package">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jjshome<span class="token punctuation">.</span>mobile<span class="token punctuation">.</span>autotrackings</span><span class="token punctuation">;</span>

<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>build<span class="token punctuation">.</span>api<span class="token punctuation">.</span>instrumentation<span class="token punctuation">.</span></span><span class="token class-name">FramesComputationMode</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>build<span class="token punctuation">.</span>api<span class="token punctuation">.</span>instrumentation<span class="token punctuation">.</span></span><span class="token class-name">InstrumentationScope</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>build<span class="token punctuation">.</span>api<span class="token punctuation">.</span>variant<span class="token punctuation">.</span></span><span class="token class-name">AndroidComponentsExtension</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>build<span class="token punctuation">.</span>api<span class="token punctuation">.</span>variant<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>

<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Action</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Plugin</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Project</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword keyword-@author">@author</span>: zeting
 * <span class="token keyword keyword-@date">@date</span>: 2023/10/23
 * 埋点插件
 */</span>
<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">TrackingPlugin80</span> <span class="token keyword keyword-implements">implements</span> <span class="token class-name">Plugin</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Project</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-final">final</span> <span class="token class-name">String</span> <span class="token constant">TAG</span> <span class="token operator">=</span> <span class="token string">"ASM-Plugin"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token class-name">Project</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG</span> <span class="token operator">+</span> <span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt; apply "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">AndroidComponentsExtension</span> comp <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">getExtensions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getByType</span><span class="token punctuation">(</span><span class="token class-name">AndroidComponentsExtension</span><span class="token punctuation">.</span><span class="token keyword keyword-class">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        comp<span class="token punctuation">.</span><span class="token function">onVariants</span><span class="token punctuation">(</span>comp<span class="token punctuation">.</span><span class="token function">selector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Action</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">Component</span> variant<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                variant<span class="token punctuation">.</span><span class="token function">transformClassesWith</span><span class="token punctuation">(</span><span class="token class-name">TrackingFactory80</span><span class="token punctuation">.</span><span class="token keyword keyword-class">class</span><span class="token punctuation">,</span> <span class="token class-name">InstrumentationScope</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">,</span> v <span class="token operator">-&gt;</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                variant<span class="token punctuation">.</span><span class="token function">setAsmFramesComputationMode</span><span class="token punctuation">(</span><span class="token class-name">FramesComputationMode</span><span class="token punctuation">.</span><span class="token constant">COMPUTE_FRAMES_FOR_INSTRUMENTED_METHODS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><ul>
<li>TrackingFactory80</li>
</ul>
<pre data-role="codeBlock" data-info="java" class="language-java java"><code><span class="token keyword keyword-package">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jjshome<span class="token punctuation">.</span>mobile<span class="token punctuation">.</span>autotrackings</span><span class="token punctuation">;</span>

<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>build<span class="token punctuation">.</span>api<span class="token punctuation">.</span>instrumentation<span class="token punctuation">.</span></span><span class="token class-name">AsmClassVisitorFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>build<span class="token punctuation">.</span>api<span class="token punctuation">.</span>instrumentation<span class="token punctuation">.</span></span><span class="token class-name">ClassContext</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>build<span class="token punctuation">.</span>api<span class="token punctuation">.</span>instrumentation<span class="token punctuation">.</span></span><span class="token class-name">ClassData</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>build<span class="token punctuation">.</span>api<span class="token punctuation">.</span>instrumentation<span class="token punctuation">.</span></span><span class="token class-name">InstrumentationParameters</span></span><span class="token punctuation">;</span>

<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">ClassVisitor</span></span><span class="token punctuation">;</span>

<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">groovyjarjarantlr4<span class="token punctuation">.</span>v4<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span><span class="token class-name">NotNull</span></span><span class="token punctuation">;</span>


<span class="token doc-comment comment">/**
 * <span class="token keyword keyword-@author">@author</span>: zeting
 * <span class="token keyword keyword-@date">@date</span>: 2023/10/23
 * 埋点插件
 */</span>
<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-abstract">abstract</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">TrackingFactory80</span> <span class="token keyword keyword-implements">implements</span> <span class="token class-name">AsmClassVisitorFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">InstrumentationParameters<span class="token punctuation">.</span>None</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-final">final</span> <span class="token class-name">String</span> <span class="token constant">TAG</span> <span class="token operator">=</span> <span class="token string">"ASM-Factory"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword keyword-public">public</span> <span class="token class-name">ClassVisitor</span> <span class="token function">createClassVisitor</span><span class="token punctuation">(</span><span class="token class-name">ClassContext</span> classContext<span class="token punctuation">,</span> <span class="token class-name">ClassVisitor</span> classVisitor<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG</span> <span class="token operator">+</span> <span class="token string">" classContext:"</span> <span class="token operator">+</span> classContext<span class="token punctuation">.</span><span class="token function">getCurrentClassData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG</span> <span class="token operator">+</span> <span class="token string">" classVisitor:"</span> <span class="token operator">+</span> classVisitor<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 方法中间插入埋点</span>
        <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">TrackingClassNode80</span><span class="token punctuation">(</span>classVisitor<span class="token punctuation">,</span> classContext<span class="token punctuation">.</span><span class="token function">getCurrentClassData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-boolean">boolean</span> <span class="token function">isInstrumentable</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NotNull</span> <span class="token class-name">ClassData</span> classData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> className <span class="token operator">=</span> classData<span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>className<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"com.trade.eight."</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><ul>
<li>TrackingClassNode80</li>
</ul>
<pre data-role="codeBlock" data-info="java" class="language-java java"><code><span class="token keyword keyword-package">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jjshome<span class="token punctuation">.</span>mobile<span class="token punctuation">.</span>autotrackings</span><span class="token punctuation">;</span>


<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>jjshome<span class="token punctuation">.</span>mobile<span class="token punctuation">.</span>autotrackings<span class="token punctuation">.</span>entiy<span class="token punctuation">.</span></span><span class="token class-name">AnalyticsHookConfig</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>jjshome<span class="token punctuation">.</span>mobile<span class="token punctuation">.</span>autotrackings<span class="token punctuation">.</span>entiy<span class="token punctuation">.</span></span><span class="token class-name">AnalyticsMethodObj</span></span><span class="token punctuation">;</span>

<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">AnnotationVisitor</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">ClassVisitor</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">Handle</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">MethodVisitor</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">Opcodes</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">Type</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">TypePath</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span>commons<span class="token punctuation">.</span></span><span class="token class-name">AdviceAdapter</span></span><span class="token punctuation">;</span>

<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword keyword-@author">@author</span>: zeting
 * <span class="token keyword keyword-@date">@date</span>: 2023/10/23
 * 给点击事件添加埋点
 */</span>
<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">TrackingClassNode80</span> <span class="token keyword keyword-extends">extends</span> <span class="token class-name">ClassVisitor</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-final">final</span> <span class="token class-name">String</span> <span class="token constant">TAG</span> <span class="token operator">=</span> <span class="token string">"ASM-ClassNode"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-final">final</span> <span class="token class-name">String</span> <span class="token constant">TAG_LAMBDA</span> <span class="token operator">=</span> <span class="token string">"ASM-Lambda"</span><span class="token punctuation">;</span>

    <span class="token comment">// 解析类名字</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name">String</span> className<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 存储 Lambda 和方法对应字节码关系
     */</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">AnalyticsMethodObj</span><span class="token punctuation">&gt;</span></span> mLambdaMethodCells <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-public">public</span> <span class="token class-name">TrackingClassNode80</span><span class="token punctuation">(</span><span class="token class-name">ClassVisitor</span> visitor<span class="token punctuation">,</span> <span class="token class-name">String</span> className<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-super">super</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ASM7</span><span class="token punctuation">,</span> visitor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>className <span class="token operator">=</span> className<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">visit</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> version<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> access<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> signature<span class="token punctuation">,</span> <span class="token class-name">String</span> superName<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> interfaces<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token doc-comment comment">/**
         * version:52 access:32
         * name:com/zzt/zztapt/act/ActTestJava3$1
         * signature:null
         * superName:java/lang/Object
         * interfaces:[android/view/View$OnClickListener]
         */</span>
        <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">visit</span><span class="token punctuation">(</span>version<span class="token punctuation">,</span> access<span class="token punctuation">,</span> name<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> superName<span class="token punctuation">,</span> interfaces<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword keyword-public">public</span> <span class="token class-name">AnnotationVisitor</span> <span class="token function">visitTypeAnnotation</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> typeRef<span class="token punctuation">,</span> <span class="token class-name">TypePath</span> typePath<span class="token punctuation">,</span> <span class="token class-name">String</span> descriptor<span class="token punctuation">,</span> <span class="token keyword keyword-boolean">boolean</span> visible<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">visitTypeAnnotation</span><span class="token punctuation">(</span>typeRef<span class="token punctuation">,</span> typePath<span class="token punctuation">,</span> descriptor<span class="token punctuation">,</span> visible<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 访问标志，方法名，方法描述符，泛型签名和抛出异常列表，返回一个MethodVisitor
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword keyword-public">public</span> <span class="token class-name">MethodVisitor</span> <span class="token function">visitMethod</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> access<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> descriptor<span class="token punctuation">,</span> <span class="token class-name">String</span> signature<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> exceptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//        System.out.println(TAG + "&gt;&gt;&gt;&gt;&gt;&gt; visitMethod  access:" + access + " name:" + name + " descriptor:" + descriptor + " signature:" + signature + " exceptions:" + Arrays.toString(exceptions));</span>
        <span class="token class-name">MethodVisitor</span> methodVisitor <span class="token operator">=</span> <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">visitMethod</span><span class="token punctuation">(</span>access<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> exceptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">AdviceAdapter</span> newMethodVisitor <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">AdviceAdapter</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ASM7</span><span class="token punctuation">,</span> methodVisitor<span class="token punctuation">,</span> access<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token doc-comment comment">/**
             * lambda表达式和方法 使用
             * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">name</span> the method's name.
             * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">descriptor</span> the method's descriptor (see <span class="token punctuation">{</span><span class="token keyword keyword-@link">@link</span> <span class="token reference"><span class="token class-name">Type</span></span><span class="token punctuation">}</span>).
             * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">bsm</span> the bootstrap method.
             * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">bsmArgs</span> the bootstrap method constant arguments. Each argument must be
             *     an <span class="token punctuation">{</span><span class="token keyword keyword-@link">@link</span> <span class="token reference"><span class="token class-name">Integer</span></span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token keyword keyword-@link">@link</span> <span class="token reference"><span class="token class-name">Float</span></span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token keyword keyword-@link">@link</span> <span class="token reference"><span class="token class-name">Long</span></span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token keyword keyword-@link">@link</span> <span class="token reference"><span class="token class-name">Double</span></span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token keyword keyword-@link">@link</span> <span class="token reference"><span class="token class-name">String</span></span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token keyword keyword-@link">@link</span>
             *     <span class="token reference"><span class="token class-name">Type</span></span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token keyword keyword-@link">@link</span> <span class="token reference"><span class="token class-name">Handle</span></span><span class="token punctuation">}</span> or <span class="token punctuation">{</span> ConstantDynamic<span class="token punctuation">}</span> value. This method is allowed to modify
             *     the content of the array so a caller should expect that this array may change.
             */</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">visitInvokeDynamicInsn</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> descriptor<span class="token punctuation">,</span> <span class="token class-name">Handle</span> bsm<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> bsmArgs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token doc-comment comment">/**
                 * name:onClick
                 * descriptor:()Landroid/view/View$OnClickListener;
                 * bsm:java/lang/invoke/LambdaMetafactory.metafactory(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodHandle;Ljava/lang/invoke/MethodType;)Ljava/lang/invoke/CallSite; (6)
                 * bsmArgs:[(Landroid/view/View;)V, com/zzt/zztapt/act/ActTestJava3.lambda$onCreate$0(Landroid/view/View;)V (6), (Landroid/view/View;)V]
                 */</span>
                <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">visitInvokeDynamicInsn</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> descriptor<span class="token punctuation">,</span> bsm<span class="token punctuation">,</span> bsmArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//                System.err.println(TAG_LAMBDA + "&gt;&gt;&gt;&gt;&gt;&gt;&gt; visitMethod visitInvokeDynamicInsn name:" + name + " descriptor:" + descriptor + " bsm:" + bsm.toString() + " bsmArgs:" + Arrays.toString(bsmArgs));</span>
                <span class="token keyword keyword-try">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">String</span> owner <span class="token operator">=</span> bsm<span class="token punctuation">.</span><span class="token function">getOwner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token doc-comment comment">/**
                     * owner: java/lang/invoke/LambdaMetafactory
                     * 代表着 lambda
                     */</span>
                    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">"java/lang/invoke/LambdaMetafactory"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>owner<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token doc-comment comment">/**
                     * desc2: (Landroid/view/View;)V
                     */</span>
                    <span class="token class-name">String</span> desc2 <span class="token operator">=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">;</span>
                    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>bsmArgs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword keyword-instanceof">instanceof</span> <span class="token class-name">Type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        desc2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Type</span><span class="token punctuation">)</span> bsmArgs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token doc-comment comment">/** Landroid/view/View$OnClickListener;onClick(Landroid/view/View;)V
                     *  Desc：Landroid/view/View$OnClickListener;
                     *  name：onClick
                     *  desc2：(Landroid/view/View;)V
                     */</span>
                    <span class="token class-name">String</span> hookKey <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token function">getReturnType</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> name <span class="token operator">+</span> desc2<span class="token punctuation">;</span>

                    <span class="token class-name">AnalyticsMethodObj</span> sensorsAnalyticsMethodCell <span class="token operator">=</span> <span class="token class-name">AnalyticsHookConfig</span><span class="token punctuation">.</span><span class="token constant">LAMBDA_METHODS</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>hookKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>sensorsAnalyticsMethodCell <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>bsmArgs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword keyword-instanceof">instanceof</span> <span class="token class-name">Handle</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token class-name">Handle</span> it <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Handle</span><span class="token punctuation">)</span> bsmArgs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                            <span class="token doc-comment comment">/**
                             * name:lambda$onCreate$0
                             * desc:(Landroid/view/View;)V
                             */</span>
                            mLambdaMethodCells<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> it<span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sensorsAnalyticsMethodCell<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword keyword-protected">protected</span> <span class="token keyword keyword-void">void</span> <span class="token function">onMethodEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">addClickEvent</span><span class="token punctuation">(</span>methodVisitor<span class="token punctuation">,</span> access<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> exceptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">addItemClickEvent</span><span class="token punctuation">(</span>methodVisitor<span class="token punctuation">,</span> access<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> exceptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">addSwitchCompatClickEvent</span><span class="token punctuation">(</span>methodVisitor<span class="token punctuation">,</span> access<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> exceptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">addRadioGroupCompatClickEvent</span><span class="token punctuation">(</span>methodVisitor<span class="token punctuation">,</span> access<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> exceptions<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token function">addLambdaMethod</span><span class="token punctuation">(</span>methodVisitor<span class="token punctuation">,</span> access<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> exceptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onMethodEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span> newMethodVisitor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * lambda 处理
     *
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">mv</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">access</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">name</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">desc</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">signature</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">exceptions</span>
     */</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">addLambdaMethod</span><span class="token punctuation">(</span><span class="token class-name">MethodVisitor</span> mv<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> access<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">,</span> <span class="token class-name">String</span> signature<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> exceptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"lambda$"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">AnalyticsMethodObj</span> lambdaMethodCell <span class="token operator">=</span> mLambdaMethodCells<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name <span class="token operator">+</span> desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>lambdaMethodCell <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Type</span><span class="token punctuation">[</span><span class="token punctuation">]</span> types <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token function">getArgumentTypes</span><span class="token punctuation">(</span>lambdaMethodCell<span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-int">int</span> length <span class="token operator">=</span> types<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                <span class="token class-name">Type</span><span class="token punctuation">[</span><span class="token punctuation">]</span> lambdaTypes <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token function">getArgumentTypes</span><span class="token punctuation">(</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// paramStart 为访问的方法参数的下标，从 0 开始</span>
                <span class="token keyword keyword-int">int</span> paramStart <span class="token operator">=</span> lambdaTypes<span class="token punctuation">.</span>length <span class="token operator">-</span> length<span class="token punctuation">;</span>
                <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>paramStart <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>lambdaTypes<span class="token punctuation">[</span>paramStart <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>types<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG_LAMBDA</span> <span class="token operator">+</span> <span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt;  add lambda  &gt; className:"</span> <span class="token operator">+</span> className <span class="token operator">+</span> <span class="token string">" &gt; name:"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>name <span class="token operator">+</span> desc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token class-name">Boolean</span> isStaticMethod <span class="token operator">=</span> <span class="token function">isStatic</span><span class="token punctuation">(</span>access<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> i <span class="token operator">=</span> paramStart<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> paramStart <span class="token operator">+</span> lambdaMethodCell<span class="token punctuation">.</span><span class="token function">getParamsCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Integer</span> opCodeA <span class="token operator">=</span> lambdaMethodCell<span class="token punctuation">.</span><span class="token function">getOpcodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i <span class="token operator">-</span> paramStart<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">Integer</span> varB <span class="token operator">=</span> <span class="token function">getVisitPosition</span><span class="token punctuation">(</span>lambdaTypes<span class="token punctuation">,</span> i<span class="token punctuation">,</span> isStaticMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    mv<span class="token punctuation">.</span><span class="token function">visitVarInsn</span><span class="token punctuation">(</span>opCodeA<span class="token punctuation">,</span> varB<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                mv<span class="token punctuation">.</span><span class="token function">visitMethodInsn</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">INVOKESTATIC</span><span class="token punctuation">,</span> <span class="token class-name">AnalyticsHookConfig</span><span class="token punctuation">.</span><span class="token constant">EVENT_METHOD_CLAZZ</span><span class="token punctuation">,</span> lambdaMethodCell<span class="token punctuation">.</span><span class="token function">getAgentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lambdaMethodCell<span class="token punctuation">.</span><span class="token function">getAgentDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 给 View.OnClick 插入代码
     *
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">mv</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">name</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">descriptor</span>
     */</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">addClickEvent</span><span class="token punctuation">(</span><span class="token class-name">MethodVisitor</span> mv<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> access<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> descriptor<span class="token punctuation">,</span> <span class="token class-name">String</span> signature<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> exceptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token string">"onClick"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"(Landroid/view/View;)V"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">handleViewEventClick</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> mv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Listview item Click
     *
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">mv</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">access</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">name</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">descriptor</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">signature</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">exceptions</span>
     */</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">addItemClickEvent</span><span class="token punctuation">(</span><span class="token class-name">MethodVisitor</span> mv<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> access<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> descriptor<span class="token punctuation">,</span> <span class="token class-name">String</span> signature<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> exceptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token string">"onItemClick"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"(Landroid/widget/AdapterView;Landroid/view/View;IJ)V"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">handleViewAdapterViewClick</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> mv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Switch click
     *
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">mv</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">access</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">name</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">descriptor</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">signature</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">exceptions</span>
     */</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">addSwitchCompatClickEvent</span><span class="token punctuation">(</span><span class="token class-name">MethodVisitor</span> mv<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> access<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> descriptor<span class="token punctuation">,</span> <span class="token class-name">String</span> signature<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> exceptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token string">"onCheckedChanged"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"(Landroid/widget/CompoundButton;Z)V"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">handleViewEventClick</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> mv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Radio Group click
     *
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">mv</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">access</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">name</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">descriptor</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">signature</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">exceptions</span>
     */</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">addRadioGroupCompatClickEvent</span><span class="token punctuation">(</span><span class="token class-name">MethodVisitor</span> mv<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> access<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> descriptor<span class="token punctuation">,</span> <span class="token class-name">String</span> signature<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> exceptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token string">"onCheckedChanged"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"(Landroid/widget/RadioGroup;I)V"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">handleViewEventClick</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> mv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * view点击事件处理
     *
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">name</span>
     */</span>
    <span class="token keyword keyword-void">void</span> <span class="token function">handleViewEventClick</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">MethodVisitor</span> mv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG</span> <span class="token operator">+</span> <span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt; add 1 &gt; className:"</span> <span class="token operator">+</span> className <span class="token operator">+</span> <span class="token string">" &gt; name:"</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

        mv<span class="token punctuation">.</span><span class="token function">visitVarInsn</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ALOAD</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mv<span class="token punctuation">.</span><span class="token function">visitMethodInsn</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">INVOKESTATIC</span><span class="token punctuation">,</span> <span class="token string">"com/jjshome/mobile/datastatistics/DSAgent"</span><span class="token punctuation">,</span> <span class="token string">"onClickView"</span><span class="token punctuation">,</span> <span class="token string">"(Landroid/view/View;)V"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token doc-comment comment">/**
     * listview ,gridview 列表点击事件
     *
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">name</span>
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">mv</span>
     */</span>
    <span class="token keyword keyword-void">void</span> <span class="token function">handleViewAdapterViewClick</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">MethodVisitor</span> mv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG</span> <span class="token operator">+</span> <span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt;  add 3  &gt; className:"</span> <span class="token operator">+</span> className <span class="token operator">+</span> <span class="token string">" &gt; name:"</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

        mv<span class="token punctuation">.</span><span class="token function">visitVarInsn</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ALOAD</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mv<span class="token punctuation">.</span><span class="token function">visitVarInsn</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ALOAD</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mv<span class="token punctuation">.</span><span class="token function">visitVarInsn</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ILOAD</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mv<span class="token punctuation">.</span><span class="token function">visitMethodInsn</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">INVOKESTATIC</span><span class="token punctuation">,</span> <span class="token string">"com/jjshome/mobile/datastatistics/DSAgent"</span><span class="token punctuation">,</span> <span class="token string">"onAdapterClickView"</span><span class="token punctuation">,</span> <span class="token string">"(Landroid/widget/AdapterView;Landroid/view/View;I)V"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token doc-comment comment">/**
     * 获取参数类型
     *
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">descriptor</span>
     */</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">getASMMethodType</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> descriptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG</span> <span class="token operator">+</span> <span class="token string">"****************************************"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"**********************************************"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Type</span> methodType <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token function">getMethodType</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-int">int</span> sizes <span class="token operator">=</span> methodType<span class="token punctuation">.</span><span class="token function">getArgumentsAndReturnSizes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG</span> <span class="token operator">+</span> <span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt; return type: "</span> <span class="token operator">+</span> methodType<span class="token punctuation">.</span><span class="token function">getReturnType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token punctuation">(</span>sizes <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">')'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Type</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argTypes <span class="token operator">=</span> methodType<span class="token punctuation">.</span><span class="token function">getArgumentTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG</span> <span class="token operator">+</span> <span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt; "</span> <span class="token operator">+</span> argTypes<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">" arguments ("</span> <span class="token operator">+</span> <span class="token punctuation">(</span>sizes <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">')'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> ix <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ix <span class="token operator">&lt;</span> argTypes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> ix<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG</span> <span class="token operator">+</span> <span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt; arg"</span> <span class="token operator">+</span> ix <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> argTypes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">TAG</span> <span class="token operator">+</span> <span class="token string">"****************************************"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"**********************************************"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 获取View 参数位置
     *
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">descriptor</span>
     * <span class="token keyword keyword-@return">@return</span>
     */</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-int">int</span> <span class="token function">getASMMethodViewByIndex</span><span class="token punctuation">(</span><span class="token class-name">String</span> className<span class="token punctuation">,</span> <span class="token class-name">String</span> descriptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-try">try</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">isNotNull</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Type</span> methodType <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token function">getMethodType</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Type</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argTypes <span class="token operator">=</span> methodType<span class="token punctuation">.</span><span class="token function">getArgumentTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> argTypes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>className<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>argTypes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword keyword-return">return</span> k<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-return">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 获取方法参数下标为 index 的对应 ASM index
     *
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">types</span>          方法参数类型数组
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">index</span>          方法中参数下标，从 0 开始
     * <span class="token keyword keyword-@param">@param</span> <span class="token parameter">isStaticMethod</span> 该方法是否为静态方法
     * <span class="token keyword keyword-@return">@return</span> 访问该方法的 index 位参数的 ASM index
     */</span>
    <span class="token class-name">Integer</span> <span class="token function">getVisitPosition</span><span class="token punctuation">(</span><span class="token class-name">Type</span><span class="token punctuation">[</span><span class="token punctuation">]</span> types<span class="token punctuation">,</span> <span class="token class-name">Integer</span> index<span class="token punctuation">,</span> <span class="token keyword keyword-boolean">boolean</span> isStaticMethod<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>types <span class="token operator">==</span> <span class="token keyword keyword-null">null</span> <span class="token operator">||</span> index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> index <span class="token operator">&gt;=</span> types<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"getVisitPosition error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-return">return</span> isStaticMethod <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-return">return</span> <span class="token function">getVisitPosition</span><span class="token punctuation">(</span>types<span class="token punctuation">,</span> index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> isStaticMethod<span class="token punctuation">)</span> <span class="token operator">+</span> types<span class="token punctuation">[</span>index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-boolean">boolean</span> <span class="token function">isPrivate</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> access<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>access <span class="token operator">&amp;</span> <span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ACC_PRIVATE</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-boolean">boolean</span> <span class="token function">isSynthetic</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> access<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>access <span class="token operator">&amp;</span> <span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ACC_SYNTHETIC</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-boolean">boolean</span> <span class="token function">isStatic</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> access<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>access <span class="token operator">&amp;</span> <span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ACC_STATIC</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-boolean">boolean</span> <span class="token function">isFinal</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> access<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>access <span class="token operator">&amp;</span> <span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ACC_FINAL</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-boolean">boolean</span> <span class="token function">isNotNull</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> str <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><ul>
<li>AnalyticsHookConfig</li>
</ul>
<pre data-role="codeBlock" data-info="java" class="language-java java"><code><span class="token keyword keyword-package">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jjshome<span class="token punctuation">.</span>mobile<span class="token punctuation">.</span>autotrackings<span class="token punctuation">.</span>entiy</span><span class="token punctuation">;</span>

<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">Opcodes</span></span><span class="token punctuation">;</span>

<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword keyword-@author">@author</span>: zeting
 * <span class="token keyword keyword-@date">@date</span>: 2023/11/13
 * 配置的分析信息
 */</span>
<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">AnalyticsHookConfig</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * 分析埋点插入类
     */</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token class-name">String</span> <span class="token constant">EVENT_METHOD_CLAZZ</span> <span class="token operator">=</span> <span class="token string">"com/jjshome/mobile/datastatistics/DSAgent"</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">AnalyticsMethodObj</span><span class="token punctuation">&gt;</span></span> <span class="token constant">LAMBDA_METHODS</span> <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-static">static</span> <span class="token punctuation">{</span>
        <span class="token function">addLambdaMethod</span><span class="token punctuation">(</span>
                <span class="token keyword keyword-new">new</span> <span class="token class-name">AnalyticsMethodObj</span><span class="token punctuation">(</span>
                        <span class="token string">"onClick"</span><span class="token punctuation">,</span>
                        <span class="token string">"(Landroid/view/View;)V"</span><span class="token punctuation">,</span>
                        <span class="token string">"Landroid/view/View$OnClickListener;"</span><span class="token punctuation">,</span>
                        <span class="token string">"onClickView"</span><span class="token punctuation">,</span>
                        <span class="token string">"(Landroid/view/View;)V"</span><span class="token punctuation">,</span>
                        <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                        <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ALOAD</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addLambdaMethod</span><span class="token punctuation">(</span>
                <span class="token keyword keyword-new">new</span> <span class="token class-name">AnalyticsMethodObj</span><span class="token punctuation">(</span>
                        <span class="token string">"onCheckedChanged"</span><span class="token punctuation">,</span>
                        <span class="token string">"(Landroid/widget/CompoundButton;Z)V"</span><span class="token punctuation">,</span>
                        <span class="token string">"Landroid/widget/CompoundButton$OnCheckedChangeListener;"</span><span class="token punctuation">,</span>
                        <span class="token string">"onClickView"</span><span class="token punctuation">,</span>
                        <span class="token string">"(Landroid/view/View;)V"</span><span class="token punctuation">,</span>
                        <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                        <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ALOAD</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addLambdaMethod</span><span class="token punctuation">(</span>
                <span class="token keyword keyword-new">new</span> <span class="token class-name">AnalyticsMethodObj</span><span class="token punctuation">(</span>
                        <span class="token string">"onCheckedChanged"</span><span class="token punctuation">,</span>
                        <span class="token string">"(Landroid/widget/RadioGroup;I)V"</span><span class="token punctuation">,</span>
                        <span class="token string">"Landroid/widget/RadioGroup$OnCheckedChangeListener;"</span><span class="token punctuation">,</span>
                        <span class="token string">"onClickView"</span><span class="token punctuation">,</span>
                        <span class="token string">"(Landroid/view/View;)V"</span><span class="token punctuation">,</span>
                        <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                        <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ALOAD</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addLambdaMethod</span><span class="token punctuation">(</span>
                <span class="token keyword keyword-new">new</span> <span class="token class-name">AnalyticsMethodObj</span><span class="token punctuation">(</span>
                        <span class="token string">"onItemClick"</span><span class="token punctuation">,</span>
                        <span class="token string">"(Landroid/widget/AdapterView;Landroid/view/View;IJ)V"</span><span class="token punctuation">,</span>
                        <span class="token string">"Landroid/widget/AdapterView$OnItemClickListener;"</span><span class="token punctuation">,</span>
                        <span class="token string">"onAdapterClickView"</span><span class="token punctuation">,</span>
                        <span class="token string">"(Landroid/widget/AdapterView;Landroid/view/View;I)V"</span><span class="token punctuation">,</span>
                        <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
                        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ALOAD</span><span class="token punctuation">,</span> <span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ALOAD</span><span class="token punctuation">,</span> <span class="token class-name">Opcodes</span><span class="token punctuation">.</span><span class="token constant">ILOAD</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-void">void</span> <span class="token function">addLambdaMethod</span><span class="token punctuation">(</span><span class="token class-name">AnalyticsMethodObj</span> sensorsAnalyticsMethodCell<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>sensorsAnalyticsMethodCell <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token constant">LAMBDA_METHODS</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>
                    sensorsAnalyticsMethodCell<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> sensorsAnalyticsMethodCell<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> sensorsAnalyticsMethodCell<span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    sensorsAnalyticsMethodCell
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><ul>
<li>AnalyticsMethodObj</li>
</ul>
<pre data-role="codeBlock" data-info="java" class="language-java java"><code><span class="token keyword keyword-package">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jjshome<span class="token punctuation">.</span>mobile<span class="token punctuation">.</span>autotrackings<span class="token punctuation">.</span>entiy</span><span class="token punctuation">;</span>

<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword keyword-import">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Objects</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword keyword-@author">@author</span>: zeting
 * <span class="token keyword keyword-@date">@date</span>: 2023/11/13
 * 分析信息参数
 */</span>
<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">AnalyticsMethodObj</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * 方法名字
     */</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 方法参数和返回值描述
     */</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name">String</span> desc<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 方法所在的接口或类
     */</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name">String</span> parent<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 调用采集数据方法
     */</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name">String</span> agentName<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 采集数据的方法描述
     */</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name">String</span> agentDesc<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 采集数据的方法参数起始索引（ 0：this，1+：普通参数 ）
     */</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name">Integer</span> paramsStart<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 采集数据的方法参数个数
     */</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name">Integer</span> paramsCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 参数类型对应的ASM指令，加载不同类型的参数需要不同的指令
     */</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> opcodes<span class="token punctuation">;</span>

    <span class="token keyword keyword-public">public</span> <span class="token class-name">AnalyticsMethodObj</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">,</span> <span class="token class-name">String</span> parent<span class="token punctuation">,</span> <span class="token class-name">String</span> agentName<span class="token punctuation">,</span> <span class="token class-name">String</span> agentDesc<span class="token punctuation">,</span> <span class="token class-name">Integer</span> paramsStart<span class="token punctuation">,</span> <span class="token class-name">Integer</span> paramsCount<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> opcodes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>desc <span class="token operator">=</span> desc<span class="token punctuation">;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>agentName <span class="token operator">=</span> agentName<span class="token punctuation">;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>agentDesc <span class="token operator">=</span> agentDesc<span class="token punctuation">;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>paramsStart <span class="token operator">=</span> paramsStart<span class="token punctuation">;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>paramsCount <span class="token operator">=</span> paramsCount<span class="token punctuation">;</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>opcodes <span class="token operator">=</span> opcodes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token class-name">String</span> <span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> desc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">setDesc</span><span class="token punctuation">(</span><span class="token class-name">String</span> desc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>desc <span class="token operator">=</span> desc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token class-name">String</span> <span class="token function">getAgentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> agentName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">setAgentName</span><span class="token punctuation">(</span><span class="token class-name">String</span> agentName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>agentName <span class="token operator">=</span> agentName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token class-name">String</span> <span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> parent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">setParent</span><span class="token punctuation">(</span><span class="token class-name">String</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token class-name">String</span> <span class="token function">getAgentDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> agentDesc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">setAgentDesc</span><span class="token punctuation">(</span><span class="token class-name">String</span> agentDesc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>agentDesc <span class="token operator">=</span> agentDesc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token class-name">Integer</span> <span class="token function">getParamsStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> paramsStart<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">setParamsStart</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> paramsStart<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>paramsStart <span class="token operator">=</span> paramsStart<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token class-name">Integer</span> <span class="token function">getParamsCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> paramsCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">setParamsCount</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> paramsCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>paramsCount <span class="token operator">=</span> paramsCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token function">getOpcodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> opcodes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-void">void</span> <span class="token function">setOpcodes</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> opcodes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>opcodes <span class="token operator">=</span> opcodes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-boolean">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token keyword keyword-this">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>o <span class="token keyword keyword-instanceof">instanceof</span> <span class="token class-name">AnalyticsMethodObj</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">AnalyticsMethodObj</span> that <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">AnalyticsMethodObj</span><span class="token punctuation">)</span> o<span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> that<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> that<span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">getAgentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> that<span class="token punctuation">.</span><span class="token function">getAgentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> that<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">getAgentDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> that<span class="token punctuation">.</span><span class="token function">getAgentDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">getParamsStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> that<span class="token punctuation">.</span><span class="token function">getParamsStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">getParamsCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> that<span class="token punctuation">.</span><span class="token function">getParamsCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">getOpcodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> that<span class="token punctuation">.</span><span class="token function">getOpcodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-int">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getAgentName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getAgentDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getParamsStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getParamsCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getOpcodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword keyword-public">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token string">"SensorsAnalyticsMethodCell{"</span> <span class="token operator">+</span>
                <span class="token string">"name='"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token string">", desc='"</span> <span class="token operator">+</span> desc <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token string">", agentName='"</span> <span class="token operator">+</span> agentName <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token string">", parent='"</span> <span class="token operator">+</span> parent <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token string">", agentDesc='"</span> <span class="token operator">+</span> agentDesc <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token string">", paramsStart="</span> <span class="token operator">+</span> paramsStart <span class="token operator">+</span>
                <span class="token string">", paramsCount="</span> <span class="token operator">+</span> paramsCount <span class="token operator">+</span>
                <span class="token string">", opcodes="</span> <span class="token operator">+</span> opcodes <span class="token operator">+</span>
                <span class="token char">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><p>修改文件后，执行一下 Task.publish</p>
<p><img src="https://gitee.com/ZeTing/UploadImg/raw/main/img/20250123162155.png" alt=""></p>
<p>会生成一个 1.5 插件<br>
<img src="https://gitee.com/ZeTing/UploadImg/raw/main/img/20250123162337.png" alt=""></p>
<p>修改根目录下的 build.gradle ，替换插件版本号<br>
<img src="https://gitee.com/ZeTing/UploadImg/raw/main/img/20250123162434.png" alt=""></p>
<h2 id="错误如果用到下面错误">错误如果用到下面错误， </h2>
<pre data-role="codeBlock" data-info="" class="language-text"><code>Execution failed for task ':AppCommon:transform_debugDebugClassesWithAsm'.
&gt; A failure occurred while executing com.android.build.gradle.tasks.TransformClassesWithAsmTask$TransformClassesIncrementalAction
   &gt; Error occurred while instrumenting class com.trade.eight.moudle.mission.vm.base.LoadUiState

</code></pre><p><strong>解决方法</strong><br>
直接把 LoadUiState 文件给删除，目前没有用</p>
<h1 id="问题四">问题四 </h1>
<p>后续问题</p>
<ol>
<li>Echat 聊天页面没有适配，会跑到导航栏下面去<br>
<img src="https://gitee.com/ZeTing/UploadImg/raw/main/img/20250123184117.png" alt=""></li>
</ol>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>